<%- include('../partials/header') %>
<%- include('../partials/navbarAdmin', {pages: "lihat_user" ,}) %>
<%- include('../partials/message') %>

<div class="container">
    <div class="row mt-3">
        <div class="col-lg-6">
            <div class="card kanan " style="border:1px dotted grey;">
                <div class="card-header text-center pt-4">
                    <h5>Guru</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Guru</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="table-body-guru">
                                <% for (let i = 0; i < data_guru.length; i++) { %>
                                <tr class="table-row">
                                    <td><%= (i + 1) %></td>
                                    <td><%= data_guru[i].nama %></td>
                                    <td>
                                        <div class="dropdown">
                                            <button class="btn btn-link dropdown-toggle" type="button"
                                                id="dropdownMenuButtonGuru<%= i %>" data-bs-toggle="dropdown"
                                                aria-expanded="false"></button>
                                            <ul class="dropdown-menu"
                                                aria-labelledby="dropdownMenuButtonGuru<%= i %>">
                                                <li>
                                                    <form action="/admin/lihatUser/delete/<%= data_guru[i].id %>"
                                                        method="post">
                                                        <button type="submit" class="dropdown-item">Delete</button>
                                                    </form>
                                                </li>
                                            </ul>
                                        </div>
                                    </td>
                                </tr>
                                <% } %>
                            </tbody>
                        </table>
                    </div>
                    <div class="text-center mt-3">
                        <button id="toggle-table-guru" class="btn btn-transparent">Selengkapnya</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="card kanan " style="border:1px dotted grey;">
                <div class="card-header text-center pt-4">
                    <h5>Siswa</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Siswa</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="table-body-siswa">
                                <% for (let i = 0; i < data_siswa.length; i++) { %>
                                <tr class="table-row">
                                    <td><%= (i + 1) %></td>
                                    <td><%= data_siswa[i].nama %></td>
                                    <td>
                                        <div class="dropdown">
                                            <button class="btn btn-link dropdown-toggle" type="button"
                                                id="dropdownMenuButtonSiswa<%= i %>" data-bs-toggle="dropdown"
                                                aria-expanded="false"></button>
                                            <ul class="dropdown-menu"
                                                aria-labelledby="dropdownMenuButtonSiswa<%= i %>">
                                                <li>
                                                    <form action="/admin/lihatUser/delete/<%= data_siswa[i].id %>"
                                                        method="post">
                                                        <button type="submit" class="dropdown-item">Delete</button>
                                                    </form>
                                                </li>
                                            </ul>
                                        </div>
                                    </td>
                                </tr>
                                <% } %>
                            </tbody>
                        </table>
                    </div>
                    <div class="text-center mt-3">
                        <button id="toggle-table-siswa" class="btn btn-transparent">Selengkapnya</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const guruRows = document.querySelectorAll('#table-body-guru .table-row');
        const siswaRows = document.querySelectorAll('#table-body-siswa .table-row');
        const toggleGuruBtn = document.getElementById('toggle-table-guru');
        const toggleSiswaBtn = document.getElementById('toggle-table-siswa');

        let isGuruExpanded = false;
        let isSiswaExpanded = false;
        const visibleRows = 4;

        function updateTable(rows, isExpanded, toggleBtn) {
            rows.forEach((row, index) => {
                if (isExpanded || index < visibleRows) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });

            toggleBtn.textContent = isExpanded ? 'Tutup' : 'Selengkapnya';
        }

        toggleGuruBtn.addEventListener('click', () => {
            isGuruExpanded = !isGuruExpanded;
            updateTable(guruRows, isGuruExpanded, toggleGuruBtn);
        });

        toggleSiswaBtn.addEventListener('click', () => {
            isSiswaExpanded = !isSiswaExpanded;
            updateTable(siswaRows, isSiswaExpanded, toggleSiswaBtn);
        });

        updateTable(guruRows, isGuruExpanded, toggleGuruBtn);
        updateTable(siswaRows, isSiswaExpanded, toggleSiswaBtn);
    });
</script>
<%- include('../partials/footer') %>
